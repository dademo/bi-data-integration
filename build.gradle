/*
 * This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at https://mozilla.org/MPL/2.0/.
 */

allprojects {
    repositories {
        mavenCentral()
        mavenLocal()
    }

    afterEvaluate {

        (project.tasks.withType(JavaCompile).findAll { it.enabled }).each {
            it.options.deprecation = true
            it.options.warnings = true
            it.options.compilerArgs << "-Xlint:unchecked"
        }

        (project.tasks.withType(Test).findAll { it.enabled }).each {
            it.finalizedBy jacocoTestReport
        }

        if (project.with { it.plugins.withType(JacocoPlugin) }) {
            project.tasks.jacocoTestReport {
                dependsOn test

                reports {
                    html.enabled true
                    xml.enabled true
                    csv.enabled false
                }
            }
        }
    }
}
